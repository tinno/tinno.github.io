<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
<title>刮卡中奖</title>
<style type="text/css">
#canvas canvas {
	display: block;
	background: url('http://image.zcool.com.cn/2013/54/61/c_m_1381899172289.jpg') 0 0 no-repeat;
	margin: auto;
}
</style>
</head>

<body>

<p>开始刮奖吧</p>
<div id="canvas"></div>


<script type="text/javascript">


function scrape(container, width, height, fillColor) {
	if (!document.createElement('canvas').getContext) {
		alert('您的浏览器不支持刮刮卡效果哦~！');
		return ;
	}
	var div = typeof (container) == 'string' ? document.getElementById(container) : container;
	if (!container) {
		console.error('缺少容器');
		return ;
	}
	var canvas = document.createElement('canvas');
	canvas.width = width || 100;
	canvas.height = height || 100;
	div.appendChild(canvas);

	var ctx = canvas.getContext('2d');


	ctx.init = function(fillColor) {
		ctx.fillStyle = fillColor;
		ctx.fillRect(0, 0, width, height);
	};

	ctx.init(fillColor || "#bbb");


	ctx.fillCircle = function(x, y, radius) {
		var grd=this.createRadialGradient(x,y,0,x,y,15);
		grd.addColorStop(0,"#f00");
		grd.addColorStop(1,'rgba(0,0,0,0)');

		this.fillStyle = grd;
		this.beginPath();
		this.moveTo(x, y);
		this.shadowBlur=10;
		this.shadowColor='#000';
		this.arc(x, y, radius, 0, Math.PI * 2, false);
		this.fill();
	};

	canvas.addEventListener('touchstart',function(e) {
		e.preventDefault();
		canvas.isDrawing = true;
	},false);

	canvas.addEventListener('touchmove',function(e) {
		e.preventDefault();
		if (!canvas.isDrawing) {
			return;
		}

		var x = e.touches[0].pageX - this.offsetLeft;
		var y = e.touches[0].pageY - this.offsetTop;

		var radius = 15;
		ctx.globalCompositeOperation = 'destination-out'; // 核心语句
		ctx.fillCircle(x, y, radius);
	},false);

	canvas.addEventListener('touchend',function(e) {
		e.preventDefault();
		canvas.isDrawing = false;
	},false);

}


scrape(document.getElementById('canvas'), 250, 80);


</script>
</body>
</html>